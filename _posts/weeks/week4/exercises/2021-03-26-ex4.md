---
date: 2021-03-26
title: Exercises 3.7 - 4.2
categories: Week4
tags: week4 exercises
# 목차
toc: true  
toc_sticky: true
toc_label: "Table of Contents" 
---

# Chapter 3. Systems of Linear Equations

## 3.7 Matrix Factorizations; $LU$-Decomposition

### Exercise 3.6. (*LU-decompositions*)

In this problem, we find an $$LU$$-decomposition of $$A$$, where $$A$$ is given in the of the Section $$3.7$$.

1.  Find an $LU$-decomposition of $A$ by following the procedure given
    in the Example $2$.

2.  Solve the linear system $A \mathbf{x} = \mathbf{b}$ by using the
    $LU$-decomposition of $A$ obtained in (a), where
    $\textbf{b} = \left[\begin{array}{r} 0 \\ -2 \\ 1 \end{array} \right].$

3.  Tell what happens if you use the MATLAB command *lu* of $A$. Explain
    why this result differs from the result in (a).

<!-- -->


    %(a)
    A = [6 -2 0; 9 -1 1; 3 7 5]; % Set the matrix A.

    format rat; % Display results as a rational form.

    % Initialization of U and L.
    U = A; L = eye(3); 

    % Multiply the first row by 1/6.
    U(1,:)=(1/6)*U(1,:); 
    % L(1,1) is the inverse of 1/6.
    L(1,1)=(1/6)^(-1); 

    % Add (-9) times the first to the second.
    U(2,:)=((-9)*U(1,:))+U(2,:);
    % L(2,1) is the negative of (-9).
    L(2,1)=-(-9); 

    % Add (-3) times the first to the third.
    U(3,:)=((-3)*U(1,:))+U(3,:); 
    % L(3,1) is the negative of (-3).
    L(3,1)=-(-3); 

    % Multiply the second row by 1/2.
    U(2,:)=(1/2)*U(2,:);
    % L(2,2) is the inverse of 1/2.
    L(2,2)=(1/2)^(-1); 

    % Add (-8) times the second to the third.
    U(3,:)=((-8)*U(2,:))+U(3,:); 
    % L(3,2) is the negative of (-8).
    L(3,2)=-(-8); 

    disp('A is'); disp(A);
    disp('The Lower Triangular part L is'); disp(L);
    disp('The Upper Triangular part U is'); disp(U);
    disp('The product L*U is'); disp(L*U);

    %(b)
    % Solve the linear system Ax=b 
    % by using the LU-decomposition obtained in (a).

    % First, let us solve L*y = b by forward substitution.
     % Set the right-hand-side vector b.
    b = [0 -2 1]';

     % Initialization of the solution vector y.
    y = zeros(3, 1);
    y(1) = b(1) / L(1, 1);
    y(2) = (b(2) - (L(2, 1)*y(1))) / L(2, 2);
    y(3) = (b(3) - (L(3, 1)*y(1)) - (L(3, 2)*y(2))) / L(3, 3);

    % Next, let us solve U*x = y by backward substitution.
    x = zeros(3, 1); % Initialization of the solution vector x.
    x(3) = y(3) / U(3, 3);
    x(2) = (y(2) - (U(2, 3)*x(3))) / U(2, 2);
    x(1) = (y(1) - (U(1, 3)*x(3)) - (U(1, 2)*x(2))) / U(1, 1);

    disp('The solution to Ax=b by the LU-decomposition is'); disp(x');

    % (c)
    fprintf('Using MATLAB command lu\n');
    % LU decomposition of A with a permutation matrix.
    [L U P] = lu(A);

    disp('Lower triangular part L is'); disp(L);
    disp('Upper triangular part U is'); disp(U);
    disp('The permutation matrix P is'); disp(P);
    disp('PA='); disp(P*A); disp('LU='); disp(L*U);


    A is
           6             -2              0
           9             -1              1
           3              7              5

    The Lower Triangular part L is
           6              0              0
           9              2              0
           3              8              1

    The Upper Triangular part U is
           1             -1/3            0
           0              1              1/2
           0              0              1

    The product L*U is
           6             -2              0
           9             -1              1
           3              7              5

    The solution to Ax=b by the LU-decomposition is
         -11/6          -11/2            9

    Using MATLAB command lu

    Lower triangular part L is
           1              0              0
           1/3            1              0
           2/3           -2/11           1
    Upper triangular part U is
           9             -1              1
           0             22/3           14/3
           0              0              2/11
    The permutation matrix P is
           0              1              0
           0              0              1
           1              0              0
    PA=
           9             -1              1
           3              7              5
           6             -2              0
    LU=
           9             -1              1
           3              7              5
           6             -2              0

Since the permutation matrix $P$ is not the identity matrix, the MATLAB
command *lu* gave us an $LU$-decomposition after multiplying $A$ by the
permutation matrix $P$, hence, this decomposition is a
$PLU$-decomposition of $A$ because $PA=LU$. Since at least one row
interchange of $A$ occurred in the process of $LU$-decomposition, this
result is different from the previous decomposition obtained in $(a)$.

(*LU-decomposition*)

1.  The MATLAB command *lu* is used to find the $LU$-decomposition of a
    matrix $A$. Tell what happens if you use the command $lu$ for $A$,
    where $A$ is given in the Example 2 of the Section 3.7. Explain why
    this result differs from the result in the textbook.

2.  Using MATLAB, observe what happens when you try to find an
    $LU$-decomposition of a singular matrix.

<!-- -->


    % (a)
    % Construct the matrix A.
    A=[6 -2 0; 9 -1 1; 3 7 5]; 

    % LU decomposition of A.
    [L U P]=lu(A); 
    disp('[L U P]=lu(A)');
    disp('L'); disp(L); disp('U'); disp(U); disp('P'); disp(P);

    % (b)
    % Construct the some singular matrices.
    A1=[1 0 0; -2 0 0; 4 6 1]; 
    A2=[1 -2 7; -4 8 5; 2 -4 3];
    A3=[1 0 0; -2 0 0; 4 6 1]; 

    % LU decompositions of them.
    [L1 U1 P1]=lu(A1); [L2 U2 P2]=lu(A2); [L3 U3 P3]=lu(A3); 
    disp('[L1 U1 P1]=lu(A1)'); disp('L1');disp(L1);disp('U1');disp(U1);
    disp('[L2 U2 P2]=lu(A2)'); disp('L2');disp(L2); disp('U2');disp(U2);
    disp('[L3 U3 P3]=lu(A3)'); disp('L3');disp(L3); disp('U3');disp(U3);


    [L U P]=lu(A)
    L
        1.0000         0         0
        0.3333    1.0000         0
        0.6667   -0.1818    1.0000

    U
        9.0000   -1.0000    1.0000
             0    7.3333    4.6667
             0         0    0.1818

    P
         0     1     0
         0     0     1
         1     0     0


    [L1 U1 P1]=lu(A1)
    L1
        1.0000         0         0
       -0.5000    1.0000         0
        0.2500   -0.5000    1.0000
    U1
        4.0000    6.0000    1.0000
             0    3.0000    0.5000
             0         0         0
             
    [L2 U2 P2]=lu(A2)
    L2
        1.0000         0         0
       -0.2500    1.0000         0
       -0.5000         0    1.0000
    U2
       -4.0000    8.0000    5.0000
             0         0    8.2500
             0         0    5.5000
             
    [L3 U3 P3]=lu(A3)
    L3
        1.0000         0         0
       -0.5000    1.0000         0
        0.2500   -0.5000    1.0000
    U3
        4.0000    6.0000    1.0000
             0    3.0000    0.5000
             0         0         0
             

*Remark on (a).* Since the permutation matrix $P$ is not the identity
matrix, the MATLAB command *lu* gave us an $LU$-decomposition after
multiplying $A$ by the permutation matrix $P$, hence, this decomposition
is a $PLU$-decomposition of $A$ because $PA=LU$. Since at least one row
interchange of $A$ occurred in the process of $LU$-decomposition, this
result is different from the decomposition result in the textbook.

*Remark on (b).* When we try $LU$-decomposition of the sigular matrices
using the MATLAB command *lu*, the resulting upper triangular matrices
are singular.
